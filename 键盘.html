<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”®ç›˜æ‰“é£æœºè®­ç»ƒæ¸¸æˆ</title>
    <style>
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'å¾®è½¯é›…é»‘', sans-serif;
            background-color: #f0f8ff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            text-align: center;
            padding: 20px;
        }
        
        h1 {
            color: #ff6b6b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .game-info div {
            padding: 5px 10px;
        }
        
        .game-area {
            position: relative;
            width: 100%;
            height: 400px;
            background-color: #e0f7fa;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            border: 3px solid #81d4fa;
        }
        
        .plane {
            position: absolute;
            font-size: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .plane-char {
            background-color: #ff9e80;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .plane-body {
            width: 30px;
            height: 20px;
            background-color: #ffcc80;
            border-radius: 5px 5px 0 0;
            margin-top: -5px;
        }
        
        .plane-wings {
            display: flex;
            margin-top: -5px;
        }
        
        .wing {
            width: 15px;
            height: 10px;
            background-color: #b3e5fc;
            border-radius: 5px;
        }
        
        .explosion {
            position: absolute;
            font-size: 40px;
            animation: explode 0.5s forwards;
            z-index: 10;
        }
        
        @keyframes explode {
            0% { transform: scale(0.5); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        
        button {
            background-color: #64b5f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        button:hover {
            background-color: #42a5f5;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .difficulty-selector {
            display: flex;
            align-items: center;
            margin-top: 10px;
            background-color: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .difficulty-selector label {
            margin-right: 10px;
            font-weight: bold;
            color: #0277bd;
        }
        
        .difficulty-selector input {
            width: 200px;
        }
        
        .difficulty-value {
            margin-left: 10px;
            font-weight: bold;
            color: #ff6b6b;
            width: 30px;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            z-index: 100;
            display: none;
        }
        
        .game-over h2 {
            color: #ff6b6b;
            font-size: 36px;
            margin-bottom: 20px;
        }
        
        .game-over button {
            margin-top: 20px;
            background-color: #ff6b6b;
        }
        
        .game-over button:hover {
            background-color: #ff5252;
        }
        
        .stats {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        
        .cloud {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            z-index: -1;
            animation: float linear infinite;
        }
        
        @keyframes float {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100vw); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>é”®ç›˜æ‰“é£æœºè®­ç»ƒæ¸¸æˆ</h1>
        
        <div class="game-info">
            <div>å¾—åˆ†: <span id="score">0</span></div>
            <div>ç”Ÿå‘½å€¼: <span id="lives">3</span></div>
            <div>ç­‰çº§: <span id="level">1</span></div>
            <div>æ—¶é—´: <span id="time">0</span>ç§’</div>
        </div>
        
        <div class="game-area" id="gameArea">
            <div class="game-over" id="gameOver">
                <h2>æ¸¸æˆç»“æŸ!</h2>
                <div>æœ€ç»ˆå¾—åˆ†: <span id="finalScore">0</span></div>
                <div>åšæŒæ—¶é—´: <span id="finalTime">0</span>ç§’</div>
                <div class="stats">
                    <div>æ­£ç¡®ç‡: <span id="accuracy">0</span>%</div>
                    <div>æ¯åˆ†é’Ÿå‡»é”®æ•°: <span id="kpm">0</span></div>
                </div>
                <button id="restartButton">å†æ¥ä¸€æ¬¡</button>
            </div>
        </div>
        
        <div class="controls">
            <button id="startButton">å¼€å§‹æ¸¸æˆ</button>
            <button id="pauseButton" disabled>æš‚åœ</button>
            
            <div class="difficulty-selector">
                <label for="difficulty">éš¾åº¦çº§åˆ«:</label>
                <input type="range" id="difficulty" min="1" max="10" value="1">
                <span class="difficulty-value" id="difficultyValue">1</span>
            </div>
        </div>
    </div>
    
    <script>
        // æ¸¸æˆå˜é‡
        let score = 0;
        let lives = 3;
        let level = 1;
        let gameTime = 0;
        let gameRunning = false;
        let gamePaused = false;
        let gameInterval;
        let timeInterval;
        let planes = [];
        let difficulty = 1;
        let keysPressed = 0;
        let correctKeys = 0;
        
        // DOM å…ƒç´ 
        const gameArea = document.getElementById('gameArea');
        const scoreElement = document.getElementById('score');
        const livesElement = document.getElementById('lives');
        const levelElement = document.getElementById('level');
        const timeElement = document.getElementById('time');
        const startButton = document.getElementById('startButton');
        const pauseButton = document.getElementById('pauseButton');
        const difficultySlider = document.getElementById('difficulty');
        const difficultyValue = document.getElementById('difficultyValue');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const finalTimeElement = document.getElementById('finalTime');
        const accuracyElement = document.getElementById('accuracy');
        const kpmElement = document.getElementById('kpm');
        const restartButton = document.getElementById('restartButton');
        
        // äº‹ä»¶ç›‘å¬å™¨
        startButton.addEventListener('click', startGame);
        pauseButton.addEventListener('click', togglePause);
        difficultySlider.addEventListener('input', updateDifficulty);
        restartButton.addEventListener('click', restartGame);
        document.addEventListener('keydown', handleKeyPress);
        
        // æ›´æ–°éš¾åº¦æ˜¾ç¤ºå’Œç­‰çº§
        function updateDifficulty() {
            difficulty = parseInt(difficultySlider.value);
            difficultyValue.textContent = difficulty;
            
            // æ¸¸æˆæœªå¼€å§‹æ—¶ï¼ŒåŒæ­¥æ›´æ–°ç­‰çº§æ˜¾ç¤º
            if (!gameRunning) {
                level = difficulty;
                levelElement.textContent = level;
            }
        }
        
        // åˆ›å»ºäº‘æœµèƒŒæ™¯
        function createClouds() {
            for (let i = 0; i < 10; i++) {
                createCloud();
            }
            
            // å­˜å‚¨äº‘æœµåˆ›å»ºçš„å®šæ—¶å™¨IDï¼Œä»¥ä¾¿åœ¨æ¸¸æˆç»“æŸæ—¶æ¸…é™¤
            window.cloudInterval = setInterval(createCloud, 5000);
        }
        
        function createCloud() {
            if (!gameRunning) return; // æ¸¸æˆç»“æŸæ—¶ä¸åˆ›å»ºæ–°äº‘æœµ
            
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            
            const size = Math.random() * 100 + 50;
            const top = Math.random() * gameArea.offsetHeight;
            const duration = Math.random() * 60 + 60;
            
            cloud.style.width = `${size}px`;
            cloud.style.height = `${size / 2}px`;
            cloud.style.top = `${top}px`;
            cloud.style.right = `-${size}px`;
            cloud.style.animationDuration = `${duration}s`;
            
            gameArea.appendChild(cloud);
            
            setTimeout(() => {
                if (cloud && cloud.parentNode === gameArea) {
                    gameArea.removeChild(cloud);
                }
            }, duration * 1000);
        }
        
        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            if (gameRunning) {
                // å¦‚æœæ¸¸æˆå·²ç»åœ¨è¿è¡Œï¼Œåˆ™é‡æ–°å¼€å§‹æ¸¸æˆ
                resetGame();
                gameRunning = true;
                gamePaused = false;
            } else {
                // é¦–æ¬¡å¼€å§‹æ¸¸æˆ
                resetGame();
                gameRunning = true;
                gamePaused = false;
                
                // æ›´æ”¹å¼€å§‹æŒ‰é’®æ–‡æœ¬ä¸º"é‡æ–°å¼€å§‹"
                startButton.textContent = "é‡æ–°å¼€å§‹";
                pauseButton.disabled = false;
                difficultySlider.disabled = true;
            }
            
            // å¼€å§‹ç”Ÿæˆé£æœº
            gameInterval = setInterval(createPlane, getPlaneInterval());
            
            // å¼€å§‹è®¡æ—¶
            timeInterval = setInterval(() => {
                if (!gamePaused) {
                    gameTime++;
                    timeElement.textContent = gameTime;
                    
                    // æ¯30ç§’æé«˜ä¸€ä¸ªç­‰çº§ï¼Œæœ€é«˜åˆ°10çº§
                    if (gameTime % 30 === 0 && level < 10) {
                        level++;
                        levelElement.textContent = level;
                        
                        // è°ƒæ•´é£æœºç”Ÿæˆé€Ÿåº¦
                        clearInterval(gameInterval);
                        gameInterval = setInterval(createPlane, getPlaneInterval());
                    }
                }
            }, 1000);
            
            createClouds();
        }
        
        // æ ¹æ®éš¾åº¦å’Œç­‰çº§è®¡ç®—é£æœºç”Ÿæˆé—´éš”
        function getPlaneInterval() {
            // åŸºç¡€é—´éš”ä¸º2000msï¼Œéšéš¾åº¦å’Œç­‰çº§å‡å°‘
            const baseInterval = 2000;
            const difficultyFactor = difficulty * 100;
            const levelFactor = level * 50;
            
            // æœ€å°é—´éš”ä¸º200ms
            return Math.max(200, baseInterval - difficultyFactor - levelFactor);
        }
        
        // åˆ›å»ºé£æœº
        function createPlane() {
            if (gamePaused) return;
            
            const plane = document.createElement('div');
            plane.className = 'plane';
            
            // åˆ›å»ºé£æœºå¤–è§‚
            const planeChar = document.createElement('div');
            planeChar.className = 'plane-char';
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªå­—ç¬¦
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const randomChar = chars.charAt(Math.floor(Math.random() * chars.length));
            planeChar.textContent = randomChar;
            
            // åˆ›å»ºé£æœºèº«ä½“
            const planeBody = document.createElement('div');
            planeBody.className = 'plane-body';
            
            // åˆ›å»ºé£æœºç¿…è†€
            const planeWings = document.createElement('div');
            planeWings.className = 'plane-wings';
            
            const leftWing = document.createElement('div');
            leftWing.className = 'wing';
            
            const rightWing = document.createElement('div');
            rightWing.className = 'wing';
            
            planeWings.appendChild(leftWing);
            planeWings.appendChild(rightWing);
            
            plane.appendChild(planeChar);
            plane.appendChild(planeBody);
            plane.appendChild(planeWings);
            
            // éšæœºä½ç½®
            const top = Math.random() * (gameArea.offsetHeight - 60);
            
            plane.style.top = `${top}px`;
            plane.style.right = '0';
            
            // éšæœºé¢œè‰²
            const hue = Math.floor(Math.random() * 360);
            planeChar.style.backgroundColor = `hsl(${hue}, 80%, 65%)`;
            planeBody.style.backgroundColor = `hsl(${hue}, 70%, 75%)`;
            leftWing.style.backgroundColor = `hsl(${hue - 20}, 60%, 85%)`;
            rightWing.style.backgroundColor = `hsl(${hue - 20}, 60%, 85%)`;
            
            gameArea.appendChild(plane);
            

             // å­˜å‚¨é£æœºä¿¡æ¯
            const planeInfo = {
                element: plane,
                char: randomChar,
                speed: 1 + (difficulty * 0.2) + (level * 0.1)
            };
            
            planes.push(planeInfo);
            
            // å¯åŠ¨é£æœºç§»åŠ¨
            movePlane(planeInfo);
        }
        
        // ç§»åŠ¨é£æœº
        function movePlane(planeInfo) {
            const plane = planeInfo.element;
            let position = parseInt(plane.style.right) || 0;

            function animate() {
                if (!gamePaused && gameRunning) {
                    position += planeInfo.speed;
                    plane.style.right = `${position}px`;

                    // è¾¹ç•Œæ£€æµ‹ - æ£€æµ‹å·¦ä¾§è¾¹ç¼˜
                    if (position > gameArea.offsetWidth) {
                        // é£æœºè§¦ç¢°åˆ°å·¦ä¾§è¾¹ç¼˜
                        // ç§»é™¤è¶Šç•Œçš„é£æœº
                        if (plane.parentNode === gameArea) {
                            gameArea.removeChild(plane);
                        }
                        const index = planes.indexOf(planeInfo);
                        if (index > -1) {
                            planes.splice(index, 1);
                        }
                        // æ‰£é™¤ç”Ÿå‘½å€¼
                        lives--;
                        livesElement.textContent = lives;
                        if (lives <= 0) {
                            endGame();
                        }
                    } else {
                        planeInfo.animationFrame = requestAnimationFrame(animate);
                    }
                }
            }
            animate();
        }
        
        // å¤„ç†é”®ç›˜è¾“å…¥
        function handleKeyPress(event) {
            if (!gameRunning || gamePaused) return;
            
            const key = event.key.toUpperCase();
            keysPressed++;
            
            // æŸ¥æ‰¾åŒ¹é…çš„é£æœº
            const matchingPlaneIndex = planes.findIndex(plane => plane.char === key);
            
            if (matchingPlaneIndex !== -1) {
                // å‡»ä¸­é£æœº
                const planeInfo = planes[matchingPlaneIndex];
                const plane = planeInfo.element;
                
                // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
                createExplosion(plane);
                
                // ç§»é™¤é£æœº
                if (plane && plane.parentNode === gameArea) {
                    gameArea.removeChild(plane);
                }
                planes.splice(matchingPlaneIndex, 1);
                
                // å¢åŠ åˆ†æ•°
                score += 10 * difficulty;
                scoreElement.textContent = score;
                
                // è®°å½•æ­£ç¡®æŒ‰é”®
                correctKeys++;
            }
        }
        
        // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
        function createExplosion(plane) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.textContent = 'ğŸ’¥';
            
            // è·å–é£æœºä½ç½®
            const rect = plane.getBoundingClientRect();
            const gameRect = gameArea.getBoundingClientRect();
            
            // è®¾ç½®çˆ†ç‚¸ä½ç½®
            explosion.style.top = `${rect.top - gameRect.top}px`;
            explosion.style.left = `${rect.left - gameRect.left}px`;
            
            gameArea.appendChild(explosion);
            
            // ç§»é™¤çˆ†ç‚¸æ•ˆæœ
            setTimeout(() => {
                if (explosion && explosion.parentNode === gameArea) {
                    gameArea.removeChild(explosion);
                }
            }, 500);
        }
        
        // æš‚åœ/ç»§ç»­æ¸¸æˆ
        function togglePause() {
            if (!gameRunning) return;
            
            gamePaused = !gamePaused;
            pauseButton.textContent = gamePaused ? 'ç»§ç»­' : 'æš‚åœ';
            
            // å¦‚æœæ¢å¤æ¸¸æˆï¼Œé‡æ–°å¯åŠ¨æ‰€æœ‰é£æœºçš„ç§»åŠ¨
            if (!gamePaused) {
                planes.forEach(planeInfo => {
                    // å–æ¶ˆä¹‹å‰çš„åŠ¨ç”»å¸§ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨
                    if (planeInfo.animationFrame) {
                        cancelAnimationFrame(planeInfo.animationFrame);
                    }
                    // é‡æ–°å¼€å§‹ç§»åŠ¨
                    movePlane(planeInfo);
                });
            }
        }
        
        // ç»“æŸæ¸¸æˆ
        function endGame() {
            gameRunning = false;
            gamePaused = true; // ç¡®ä¿æ¸¸æˆæš‚åœ
            
            // æ¸…é™¤å®šæ—¶å™¨
            clearInterval(gameInterval);
            clearInterval(timeInterval);
            clearInterval(window.cloudInterval); // æ¸…é™¤äº‘æœµåˆ›å»ºçš„å®šæ—¶å™¨
            
            // åœæ­¢æ‰€æœ‰é£æœº
            planes.forEach(planeInfo => {
                if (planeInfo.animationFrame) {
                    cancelAnimationFrame(planeInfo.animationFrame);
                }
            });
            
            // åœæ­¢æ‰€æœ‰äº‘æœµåŠ¨ç”»
            const clouds = gameArea.querySelectorAll('.cloud');
            clouds.forEach(cloud => {
                cloud.style.animationPlayState = 'paused';
            });
            
            // æ˜¾ç¤ºæ¸¸æˆç»“æŸç•Œé¢
            gameOverScreen.style.display = 'flex';
            
            // æ›´æ–°æœ€ç»ˆç»Ÿè®¡ä¿¡æ¯
            finalScoreElement.textContent = score;
            finalTimeElement.textContent = gameTime;
            
            // è®¡ç®—æ­£ç¡®ç‡
            const accuracy = keysPressed > 0 ? Math.round((correctKeys / keysPressed) * 100) : 0;
            accuracyElement.textContent = accuracy;
            
            // è®¡ç®—æ¯åˆ†é’Ÿå‡»é”®æ•°
            const minutes = gameTime / 60;
            const kpm = minutes > 0 ? Math.round(keysPressed / minutes) : 0;
            kpmElement.textContent = kpm;
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            startButton.disabled = false;
            pauseButton.disabled = true;
            difficultySlider.disabled = false;
        }
        
        // é‡æ–°å¼€å§‹æ¸¸æˆ
        function restartGame() {
            gameOverScreen.style.display = 'none';
            startGame();
        }
        
        // é‡ç½®æ¸¸æˆçŠ¶æ€
        function resetGame() {
            // é‡ç½®å˜é‡
            score = 0;
            lives = 3;
            // ä½¿ç”¨å½“å‰é€‰æ‹©çš„éš¾åº¦ä½œä¸ºåˆå§‹ç­‰çº§
            level = parseInt(difficultySlider.value);
            gameTime = 0;
            keysPressed = 0;
            correctKeys = 0;
            
            // æ›´æ–°æ˜¾ç¤º
            scoreElement.textContent = score;
            livesElement.textContent = lives;
            levelElement.textContent = level;
            timeElement.textContent = gameTime;
            
            // æ¸…é™¤æ‰€æœ‰é£æœº
            planes.forEach(planeInfo => {
                if (planeInfo.element.parentNode === gameArea) {
                    gameArea.removeChild(planeInfo.element);
                }
            });
            planes = [];
            
            // æ¸…é™¤æ‰€æœ‰äº‘æœµ
            const clouds = gameArea.querySelectorAll('.cloud');
            clouds.forEach(cloud => {
                if (cloud.parentNode === gameArea) {
                    gameArea.removeChild(cloud);
                }
            });
            
            // éšè—æ¸¸æˆç»“æŸç•Œé¢
            gameOverScreen.style.display = 'none';
        }
        
        // åˆå§‹åŒ–éš¾åº¦æ˜¾ç¤º
        updateDifficulty();
    </script>
</body>
</html>